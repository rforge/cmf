<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CMF – R Package Implementing the Continuous Molecular Fields Approach • conmolfields</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="CMF – R Package Implementing the Continuous Molecular Fields Approach">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">conmolfields</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/conmolfields.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>CMF – R Package Implementing the Continuous Molecular Fields Approach</h1>
            
      
      

    </div>

    
    
<div class="contents">
<div id="inrtoduction" class="section level2">
<h2 class="hasAnchor">
<a href="#inrtoduction" class="anchor"></a>1. Inrtoduction</h2>
<p>The package CMF contains a set of R functions that implement the Continuous Molecular Fields (CMF) approach to building 3D-QSAR models. The reference version of the R environment for statistical computing and graphics is 3.0.1.</p>
</div>
<div id="installation-and-setup-of-the-required-software" class="section level2">
<h2 class="hasAnchor">
<a href="#installation-and-setup-of-the-required-software" class="anchor"></a>2. Installation and Setup of the Required Software</h2>
<p>The latest version of the R environment can be downloaded and installed from the homepage of the R Project for Statistical Computing <a href="http://www.r-project.org/" class="uri">http://www.r-project.org/</a>. In order to perform visualization of molecules, molecular fields and fields of regression coefficients, it is necessary to install two additional packages: rgl and misc3d. They can be installed from the CRAN homepage <a href="http://cran.r-project.org/" class="uri">http://cran.r-project.org/</a>. In order to use quantum chemical molecular fields, it is necessary to install the MOPAC12 program <a href="http://openmopac.net/MOPAC2012.html" class="uri">http://openmopac.net/MOPAC2012.html</a>. In order to run the software implementing the CMF approach to building 3D-QSAR models, it is necessary to keep all files, including all R scripts and all data files, in the same folder (directory), which should be specified as the current working directory.</p>
</div>
<div id="the-basic-workflow-for-building-3d-qsar-models-using-the-cmf-approach" class="section level2">
<h2 class="hasAnchor">
<a href="#the-basic-workflow-for-building-3d-qsar-models-using-the-cmf-approach" class="anchor"></a>4. The Basic Workflow for Building 3D-QSAR Models Using the CMF Approach</h2>
<p>Two major modes of building and analyzing the performance of 3D-QSAR models are provided. The first one is based on a single splitting between a training set and an external (independent) test set. <em>The model built on the training set is further applied to predict activity values of compounds contained in the test set.</em> This mode requires the use of the following four input files:</p>
<ul>
<li>a file (in the mol2 format) containing 3D structures of the molecules belonging to the training set (its default name is ligands-train.mol2);</li>
<li>a file (in the delimited txt format) containing experimental (measured) activity (property) values of the corresponding chemical compounds belonging to the training set (its default name is activity-train.txt);</li>
<li>a file (in the mol2 format) containing 3D structures of the molecules belonging to the test set (its default name is ligands-pred.mol2);</li>
<li>a file (in the delimited txt format) containing experimental (measured) activity (property) values of the corresponding chemical compounds belonging to the test set (its default name is activity-pred.txt).</li>
</ul>
<p>The second mode is based on the procedure of external n-fold cross-validation. In this case the whole set of compounds is split into the training and test sets n times, so each compound appears in a test set exactly once. <em>The 3D-QSAR model built on a training set is applied to the corresponding test set, and all prediction results are accumulated.</em> This mode requires the use of the following two input files:</p>
<ul>
<li>a file (in the mol2 format) containing 3D structures of the molecules belonging to the whole set (its default name is ligands-all.mol2);</li>
<li>a file (in the delimited txt format) containing experimental (measured) activity (property) values of the corresponding chemical compounds belonging to the whole set (its default name is activity-all.txt)</li>
</ul>
</div>
<div id="aligning-molecules" class="section level2">
<h2 class="hasAnchor">
<a href="#aligning-molecules" class="anchor"></a>4.1. Aligning molecules</h2>
<p>Molecules in a dataset can be aligned using two different approaches. If the set of compounds under study is congeneric, then it can be aligned by least-square fitting (algorithm arun) to a common template substructure, which should be contained in all molecules belonging to this set. Otherwise, alignment can be performed using the seal algorithm. If the first approach is chosen, it is first necessary to obtain the template substructure to be used for performing alignment. For example, it can be extracted from some molecule by specifying a list of serial numbers of atoms. This can be accomplished using the script cmf-do-make-template.R, in which the values of the following parameters can be specified:</p>
<ul>
<li>mdb-fname – file name containing the structure from which the template substructure is to be extracted;</li>
<li>imol – the serial number of the molecule in the file mdb-fname, from which the template substructure is to be extracted;</li>
<li>atom_list – the list of serial numbers of atoms used for extracting the template substructure;</li>
<li>template_fname – file name for the template substructure.</li>
</ul>
<p>The template substructure can further be used for performing molecular alignment. This can be carried out using the following script <strong>cmf-do-make-template</strong>:</p>
<pre><code># File name of molecular databased to be aligned
mdb_fname &lt;- "ligands-train.mol2"

# Molecules from mdb_fname to be aligned
iimol &lt;- c(1:72)

# File name of template
templ_fname &lt;- "ligands-template.mol2"

# File name for aligned database
mdb_a_fname &lt;- "ligands-aligned.mol2"

# Algorithm (arun/seal)
algorithm &lt;- "arun"

mdb &lt;- read_mol2(mdb_fname)
mdb_tmp &lt;- read_mol2(templ_fname)
templ &lt;- mdb_tmp[[1]]
if (algorithm == "arun") {
  mdb_a &lt;- align_mdb_template(mdb, templ)
#  mdb_a &lt;- align_mdb_template(mdb, templ, iimol)
} else if (algorithm == "seal") {
  mdb_a &lt;- align_mdb_seal(mdb, templ)
} else {
  cat("Unknown algorithm\n")
}
write_mol2(mdb_a, mdb_a_fname)
</code></pre>
<p>in which the following parameters can be specified:</p>
<ul>
<li>mdb_fname – file name of the molecular database to be aligned;</li>
<li>iimol – List of molecules from mdb_fname to be aligned (if this parameter is dropped, the whole molecular database is to be aligned);</li>
<li>templ_fname – file name of the template substructure;</li>
<li>mdb_a_fname – file name of the produced aligned database;</li>
<li>algorithm – alignment algorithm (in this case, arun).</li>
</ul>
</div>
<div id="computing-kernels-for-the-training-set" class="section level2">
<h2 class="hasAnchor">
<a href="#computing-kernels-for-the-training-set" class="anchor"></a>4.2. Computing kernels for the training set</h2>
<p>The first step in building 3D-QSAR models using the CMF approach is to compute kernels for all pairs of compounds from the training set and to write them to a file. The kernels can be computed for five types of molecular fields:</p>
<ul>
<li>q - electrostatic molecular field;</li>
<li>vdw - steric molecular field;</li>
<li>logp - hydrophobicity field;</li>
<li>abra - hydrogen-bond acidity field;</li>
<li>abrb - hydrogen-bond basicity field.</li>
</ul>
<p>All kernels are computed for the following fixed set of attenuation parameter: 0.01, 0.05, 0.1, 0.25, 0.5, 0.75, 1.0, 2.0, 3.0, 5.0, 10.0. To carry out this kernel computation procedure, one can run the computational R script <strong>cmf-do-comp-kernels-train</strong>:</p>
<pre><code># Training set file name
train_fname &lt;- "ligands-train.mol2"

# The name of the file with kernels for training
kernels_train_fname &lt;- "ligands-kernels-train.RData"

# Molecular fields
mfields &lt;- c("q","vdw","logp","abra","abrb")

# Verbose computation of kernels (TRUE/FALSE, 1/0)
print_comp_kernels &lt;- TRUE

comp_kernels_train(
  train_fname = train_fname, 
  kernels_train_fname = kernels_train_fname, 
  mfields = mfields, 
  print_comp_kernels = print_comp_kernels
)</code></pre>
<p>The values of the following parameters may be specified by editing their default values in the script:</p>
<ul>
<li>train_fname - the name of the mol2 file containing the structures from the training set (default: “ligands-train.mol2”);</li>
<li>kernels_train_fname - the name of file with computed kernels (default: “ligands-kernels-train.RData”);</li>
<li>mfields – the list of molecular fields for which kernels should be computed (default: c(“q”,“vdw”,“logp”,“abra”,“abrb”));</li>
<li>print_comp_kernels – whether to verbose computation of kernels (TRUE/FALSE or 1/0), (default: TRUE)</li>
</ul>
</div>
<div id="building-3d-qsar-regression-model-using-the-training-set" class="section level2">
<h2 class="hasAnchor">
<a href="#building-3d-qsar-regression-model-using-the-training-set" class="anchor"></a>4.3. Building 3D-QSAR regression model using the training set</h2>
<p>The second step is to build a 3D-QSAR model and write it to a file. This is performed by running the script</p>
<pre><code># Activity file name
act_train_fname &lt;- "activity-train.txt"

# Activity column number
act_colnum &lt;- 1

# Separator
sep &lt;- ","

# Kernels file name    
kernels_train_fname &lt;- "ligands-kernels-train.RData"

# Model file name
model_fname &lt;- "ligands-model.RData"

# Types of molecular fields
mfields &lt;- c("q","vdw","logp","abra","abrb")

# Whether to perform grid search for attenuation factor alpha (TRUE/FALSE, 1/0).
alpha_grid_search &lt;- TRUE

# Whether to perform grid search for Tikhonov regularization coefficient gamma (TRUE/FALSE, 1/0).
gamma_grid_search &lt;- FALSE

# Whether to form tconic kernel combination 
conic_kernel_combination &lt;- FALSE

# Whether to optimize h (TRUE/FALSE, 1/0)
optimize_h &lt;- FALSE

# Whether to set b=0 (TRUE/FALSE, 1/0)
set_b_0 &lt;- FALSE

# Print intermediate results in the course of optimiization (TRUE/FALSE, 1/0) 
print_interm_icv &lt;- TRUE                   

# Produce intermediate scatter plots in the course of optimization  (TRUE/FALSE, 1/0)
plot_interm_icv &lt;- TRUE                   

# Print final results on interna; cross-validation (TRUE/FALSE, 1/0)
print_final_icv &lt;- TRUE

# Produce final scatter plot for internal cross-valudation (TRUE/FALSE, 1/0)                     
plot_final_icv &lt;- TRUE                       

cmf_krr_train(
  act_train_fname = act_train_fname, 
  act_colnum = act_colnum, 
  sep = sep, 
  kernels_train_fname = kernels_train_fname, 
  model_fname = model_fname, 
  mfields = mfields, 
  alpha_grid_search = alpha_grid_search,
  gamma_grid_search = gamma_grid_search, 
  conic_kernel_combination = conic_kernel_combination, 
  optimize_h = optimize_h, 
  set_b_0 = set_b_0,
  print_interm_icv = print_interm_icv,
  plot_interm_icv = plot_interm_icv,
  print_final_icv = print_final_icv,
  plot_final_icv = plot_final_icv
)
</code></pre>
<p>which implements the kernel ridge regression (KRR) algorithm. The values of the following parameters can be specified by changing their default values in this script:</p>
<ul>
<li>act_fname - the name of the text file containing the values of activity for all compounds from the training set (default: “activity-train.txt”);</li>
<li>act_colnum - activity column number in the file act_fname (default: 2);</li>
<li>sep - separator of text fields in the file act_fname containing activity values (default: “,”);</li>
<li>kernels_fname - the name of the file containing kernels computed for the training set (default: “ligands-kernels-train.RData”);</li>
<li>model_fname - the name of the file to which the 3D-QSAR model is written (default: “ligands-model.RData” );</li>
<li>alpha_grid_search- whether to perform the grid search for hyper-parameter <span class="math inline">\(\alpha\)</span>f. (TRUE/FALSE) or (1/0) [This option specifies the mode of finding the optimized values of <span class="math inline">\(\alpha\)</span>f (attenuation factor for molecular fields) values. In the first mode, when alpha_grid_search=TRUE, all values of gamma taken from the grid (the fixed set of 0.01, 0.05, 0.1, 0.25, 0.5, 0.75, 1.0, 2.0, 3.0, 5.0, 10.0) are considered, the value providing the highest Q2 is chosen. In the second mode (alpha_grid_search=FALSE) <span class="math inline">\(\gamma\)</span> is included in the list of the hyper-parameters subjected to optimization using the Nelder-Mead algorithm. In this case linear interpolation of kernel values is performed.], (default: TRUE);</li>
<li>gamma_grid_search - whether to perform the grid search for hyper-parameter gamma (TRUE/FALSE) or (1/0) [This option specifies the mode of finding the optimized values of <span class="math inline">\(\gamma\)</span> (regularization parameter in KRR) values. In the first mode, when gamma_grid_search=TRUE, all values of gamma taken from the grid (the fixed set of 0.01, 0.05, 0.1, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 2.0, 2.5, 3.0, 3.5, 4.0, 5.0, 10.0, 15.0, 20.0) are considered, the value providing the highest Q2 is chosen. In the second mode (gamma_grid_search=FALSE) <span class="math inline">\(\gamma\)</span> is included in the list of the hyper-parameters subjected to optimization using the Nelder-Mead algorithm.], (default: FALSE);</li>
<li>conic_kernel_combination - whether to form conic kernel combination (with positive mixing coefficients h) (TRUE/FALSE) or (1/0), (default: FALSE);</li>
<li>optimize_h - whether to optimize the mixing coefficients h (TRUE/FALSE) or (1/0), (default: FALSE);</li>
<li>mfields – the list of molecular fields for which kernels should be computed (default: c(“q”,“vdw”,“logp”,“abra”,“abrb”));</li>
<li>set_b_0 – whether to set the offset b=0 (this defines the difference between KRR1 and KRR2 modifications of the KRR method) (TRUE/FALSE) or (1/0), (default: FALSE);</li>
<li>print_interm_icv – whether to print intermediate results in the course of optimization (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>plot_interm_icv – whether to produce intermediate scatter plots in the course of optimization (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>print_final_icv – whether to print final results on internal cross-validation (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>plot_final_icv – whether to produce final scatter plot for internal cross-validation (TRUE/FALSE, 1/0), (default: TRUE);</li>
</ul>
</div>
<div id="the-use-of-3d-qsar-model-for-predicting-activities-of-test-set-compounds" class="section level2">
<h2 class="hasAnchor">
<a href="#the-use-of-3d-qsar-model-for-predicting-activities-of-test-set-compounds" class="anchor"></a>4.4. The Use of 3D-QSAR Model for Predicting Activities of Test Set Compounds</h2>
<p>Predicting activities of compounds belonging to the external test set is carried out in two steps. In the first step, one should compute kernels comparing molecular fields of all compounds belonging to the test set with molecular fields of all compounds belonging to the training set. To do that, it is necessary to run script</p>
<pre><code># Training set file name
train_fname &lt;- "ligands-train.mol2"

# Prediction set file name
pred_fname &lt;- "ligands-pred.mol2"

# Computed kernels file name
kernels_pred_fname &lt;- "ligands-kernels-pred.RData"

# Molecular fields
mfields &lt;- c("q", "vdw", "logp", "abra", "abrb")

# Verbose computation of kernels (TRUE/FALSE, 1/0)
print_comp_kernels &lt;- TRUE

comp_kernels_pred(
  train_fname = train_fname, 
  pred_fname = pred_fname, 
  kernels_pred_fname = kernels_pred_fname, 
  mfields = mfields, 
  print_comp_kernels = print_comp_kernels
)
</code></pre>
<p>The values of the following parameters may be modified in the script: train_fname - the name of the mol2 file containing the structures from the training set (default: “ligands-train.mol2”); pred_fname - the name of the mol2 file containing the structures from the test set (default: “ligands-pred.mol2”); kernels_pred_fname - file name for storing computed kernels (default: “ligands-kernels-pred.mol2”); mfields – the list of molecular fields for which kernels should be computed (default: c(“q”,“vdw”,“logp”,“abra”,“abrb”));</p>
<ul>
<li><p>print_comp_kernels – whether to verbose computation of kernels (TRUE/FALSE or 1/0), (default: TRUE). The second step is to make predictions by running the script cmf-do-krr-pred.R. The results of prediction is written to the file referenced by the variable pred_fname. The values of the following parameters may be modified in the script:</p></li>
<li>model_fname - the name of the file containing 3D-QSAR model (default: “ligands-model.RData”);</li>
<li>kernels_pred_fname - file name of the file containing kernels that compare molecular fields of molecules belonging to the training and the test sets (computed at the first step) (default: “ligands-kernels-pred.RData”);</li>
<li>act_colnum - the number of the column with activity values in the file act_pred_fname (If act_colnum=0 then it is assumed that the experimental values of activities are unknown) (default: 2);</li>
<li>sep - separator of text fields in the file act_pred_fname containing activity values (if act_colnum &gt; 0) (default “,”);</li>
<li>act_pred_fname - the name of the text file containing the values of activity for all compounds from the test set (if act_colnum &gt; 0) (default: “activity-pred.txt”);</li>
<li>pred_fname - file with predictions (default: “ligands-pred.RData”); print_pred – whether to print statistical parameters for prediction (TRUE/FALSE, 1/0), (default: FALSE);</li>
<li><p>plot_pred – whether to produce scatter plot prediction on external database (TRUE/FALSE, 1/0), (default: FALSE).</p></li>
</ul>
</div>
<div id="building-3d-qsar-models-using-external-n-fold-cross-validation" class="section level2">
<h2 class="hasAnchor">
<a href="#building-3d-qsar-models-using-external-n-fold-cross-validation" class="anchor"></a>4.5. Building 3D-QSAR models using external n-fold cross-validation</h2>
<p>Before building 3D-QSAR models using external n-fold cross-validation, it is necessary to compute kernels for the whole dataset. This can be done using the script</p>
<pre><code># The whole set file name
all_fname &lt;- "ligands-all.mol2"

# The name of the files containing kernels for all molecules
kernels_all_fname &lt;- "ligands-kernels-all.RData"

# Molecular fields
mfields &lt;- c("q","vdw","logp","abra","abrb")

# Verbose computation of kernels (TRUE/FALSE, 1/0)
print_comp_kernels &lt;- TRUE

comp_kernels_all(
  all_fname = all_fname, 
  kernels_all_fname = kernels_all_fname, 
  mfields = mfields, 
  print_comp_kernels = print_comp_kernels
)
</code></pre>
<p>The following parameters in it can be specified:</p>
<ul>
<li>all_fname - the name of the mol2 file containing the whole set of compounds (default: “ligands-all.mol2”);</li>
<li>kernels_all_fname - the name of file with computed kernels (default: “ligands-kernels-all.RData”);</li>
<li>mfields – the list of molecular fields for which kernels should be computed (default: c(“q”,“vdw”,“logp”,“abra”,“abrb”));</li>
<li>print_comp_kernels – whether to verbose computation of kernels (TRUE/FALSE or 1/0), (default: TRUE) After that, in order to perform external n-fold cross-validation, one can launch the script</li>
</ul>
<pre><code># The number of folds in n-folds cross-validation
nfolds &lt;- 5

# Activity file name
act_all_fname &lt;- "activity-all.txt"

# Activity column number
act_colnum &lt;- 1

# Separator
sep &lt;- ","

# Kernels file name    
kernels_all_fname &lt;- "ligands-kernels-all.RData"

# Types of molecular fields
mfields &lt;- c("q","vdw","logp","abra","abrb")

# The name of the file with external cross-validation results
ecv_fname &lt;- "ligands-ecv.RData"

# Whether to perform grid search for attenuation factor alpha (TRUE/FALSE, 1/0).
alpha_grid_search &lt;- TRUE

# Whether to perform grid search for gamma (TRUE/FALSE, 1/0).
gamma_grid_search &lt;- FALSE

# Whether to form tconic kernel combination 
# (with positive mixing coefficients) (TRUE/FALSE, 1/0)
# Conic combination preserves the positive definiteness of kernel matrices
# but leads to models with worse predictive performance assessed unsing cross-validation
conic_kernel_combination &lt;- FALSE

# Whether to optimize h (TRUE/FALSE)
optimize_h &lt;- FALSE

# Whether to set b=0 (TRUE/FALSE, 1/0)
set_b_0 &lt;- FALSE

# Print statistical parameters of the external n-folds cross-validation procedure (TRUE/FALSE, 1/0)
print_ecv &lt;- TRUE

# Produce scatter plot for external coss-validation (TRUE/FALSE, 1/0)
plot_ecv &lt;- TRUE

# Print intermediate results in the course of optimiization (TRUE/FALSE, 1/0) 
print_interm_icv &lt;- TRUE                   

# Produce intermediate scatter plots in the course of optimization  (TRUE/FALSE, 1/0)
plot_interm_icv &lt;- TRUE                   

# Print final results on interna; cross-validation (TRUE/FALSE, 1/0)
print_final_icv &lt;- TRUE

# Produce final scatter plot for internal cross-valudation (TRUE/FALSE, 1/0)                     
plot_final_icv &lt;- TRUE                       

# Print statistical parameters for prediction (TRUE/FALSE, 1/0)
print_pred &lt;- TRUE

# Produce scatter plot prediction on external database (TRUE/FALSE, 1/0)
plot_pred &lt;- TRUE    

ecv &lt;- cmf_krr_ecv(
  nfolds = nfolds, 
  act_all_fname = act_all_fname, 
  act_colnum = act_colnum, 
  sep = sep, 
  kernels_all_fname = kernels_all_fname, 
  mfields = mfields,
  ecv_fname = ecv_fname,  
  alpha_grid_search = alpha_grid_search,
  gamma_grid_search = gamma_grid_search, 
  conic_kernel_combination = conic_kernel_combination, 
  optimize_h = optimize_h, 
  set_b_0 = set_b_0,
  print_ecv = print_ecv,
  plot_ecv = plot_ecv,
  print_interm_icv = print_interm_icv,
  plot_interm_icv = plot_interm_icv,
  print_final_icv = print_final_icv,
  plot_final_icv = plot_final_icv,
  print_pred = print_pred,
  plot_pred = plot_pred
)</code></pre>
<p>in which the following parameters can be changed:</p>
<ul>
<li>nfolds – the number of folds in cross-validation (default: 5);</li>
<li>act_all_fname - the name of the text file containing the values of activity for all compounds from the training set (default: “activity-all.txt”);</li>
<li>act_colnum - activity column number in the file act_fname (default: 2);</li>
<li>sep - separator of text fields in the file act_fname containing activity values (default: “,”);</li>
<li>kernels_all_fname - the name of file with computed kernels (default: “ligands-kernels-all.RData”);</li>
<li>mfields – the list of molecular fields for which kernels should be computed (default: c(“q”,“vdw”,“logp”,“abra”,“abrb”));</li>
<li>ecv_fname - the name of the file with external cross-validation results (default: “ligands-ecv.RData”);</li>
<li>alpha_grid_search- whether to perform the grid search for hyper-parameter <span class="math inline">\(\alpha\)</span>f. (TRUE/FALSE) or (1/0) [This option specifies the mode of finding the optimized values of <span class="math inline">\(\alpha\)</span>f (attenuation factor for molecular fields) values. In the first mode, when alpha_grid_search=TRUE, all values of gamma taken from the grid (the fixed set of 0.01, 0.05, 0.1, 0.25, 0.5, 0.75, 1.0, 2.0, 3.0, 5.0, 10.0) are considered, the value providing the highest Q2 is chosen. In the second mode (alpha_grid_search=FALSE) <span class="math inline">\(\gamma\)</span> is included in the list of the hyper-parameters subjected to optimization using the Nelder-Mead algorithm. In this case linear interpolation of kernel values is performed.], (default: TRUE);</li>
<li><p>gamma_grid_search - whether to perform the grid search for hyper-parameter gamma (TRUE/FALSE) or (1/0) [This option specifies the mode of finding the optimized values of <span class="math inline">\(\gamma\)</span> (regularization parameter in KRR) values. In the first mode, when gamma_grid_search=TRUE, all values of gamma taken from the grid (the fixed set of 0.01, 0.05, 0.1, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 2.0, 2.5, 3.0, 3.5, 4.0, 5.0, 10.0, 15.0, 20.0) are considered, the value providing the highest Q2 is chosen. In the second mode (gamma_grid_search=FALSE) <span class="math inline">\(\gamma\)</span> is included in the list of the hyper-parameters subjected to optimization using the Nelder-Mead algorithm], (default: FALSE)</p></li>
<li>conic_kernel_combination - whether to form conic kernel combination (with positive mixing coefficients h) (TRUE/FALSE or 1/0), (default: FALSE);</li>
<li>optimize_h - whether to optimize the mixing coefficients h (TRUE/FALSE or 1/0), (default: FALSE);</li>
<li>set_b_0 - whether to set the offset b=0 (this defines the difference between KRR1 and KRR2 modifications of the KRR method) (TRUE/FALSE or 1/0), (default: FALSE);</li>
<li>print_ecv - print statistical parameters of the external n-folds cross-validation procedure (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>plot_ecv - produce scatter plot for external coss-validation (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>print_interm_icv – whether to print intermediate results in the course of optimization (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>plot_interm_icv – whether to produce intermediate scatter plots in the course of optimization (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>print_final_icv – whether to print final results on internal cross-validation (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>plot_final_icv – whether to produce final scatter plot for internal cross-validation (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>print_pred – whether to print statistical parameters for prediction (TRUE/FALSE, 1/0), (default: FALSE);</li>
<li><p>plot_pred – whether to produce scatter plot prediction on external database (TRUE/FALSE, 1/0), (default: FALSE). In order to perform external n-fold cross-validation with reshuffles (random renumbering of molecules), one can launch the script</p></li>
</ul>
<pre><code># The number of folds for n-folds cross-validation
nfolds &lt;- 5

# The number of reshuffles
nreshuffles &lt;- 20

# Activity file name
act_all_fname &lt;- "activity-train.txt"

# Activity column number
act_colnum &lt;- 1

# Separator
sep &lt;- ","

# Kernels file name    
kernels_all_fname &lt;- "ligands-kernels-train.RData"

# Types of molecular fields
mfields &lt;- c("q","vdw","logp","abra","abrb")

# File name for reshuffled cross-validation results
ecvr_fname &lt;- "ligands-ecvr-train.RData"

# Whether to perform grid search for attenuation factor alpha (TRUE/FALSE, 1/0).
alpha_grid_search &lt;- FALSE

# Whether to perform grid search for gamma (TRUE/FALSE, 1/0).
gamma_grid_search &lt;- FALSE

# Whether to form tconic kernel combination 
# (with positive mixing coefficients) (TRUE/FALSE, 1/0)
# Conic combination preserves the positive definiteness of kernel matrices
# but leads to models with worse predictive performance assessed unsing cross-validation
conic_kernel_combination &lt;- FALSE

# Whether to optimize h (TRUE/FALSE)
optimize_h &lt;- TRUE

# Whether to set b=0 (TRUE/FALSE, 1/0)
set_b_0 &lt;- FALSE

# Seed for random number generator (-1 - no seed)
seed &lt;- 0

# Print statistical parameters of the reshuffled external n-folds cross-validation procedure (TRUE/FALSE, 1/0)
print_ecvr &lt;- TRUE

# Produce scatter plot for reshuffled external coss-validation (TRUE/FALSE, 1/0)
plot_ecvr &lt;- TRUE

# Print statistical parameters of the external n-folds cross-validation procedure (TRUE/FALSE, 1/0)
print_ecv &lt;- TRUE

# Produce scatter plot for external coss-validation (TRUE/FALSE, 1/0)
plot_ecv &lt;- TRUE

# Print intermediate results in the course of optimiization (TRUE/FALSE, 1/0) 
print_interm_icv &lt;- FALSE                   

# Produce intermediate scatter plots in the course of optimization  (TRUE/FALSE, 1/0)
plot_interm_icv &lt;- FALSE                  

# Print final results on interna; cross-validation (TRUE/FALSE, 1/0)
print_final_icv &lt;- FALSE

# Produce final scatter plot for internal cross-valudation (TRUE/FALSE, 1/0)                     
plot_final_icv &lt;- FALSE                    

# Print statistical parameters for prediction (TRUE/FALSE, 1/0)
print_pred &lt;- FALSE

# Produce scatter plot prediction on external database (TRUE/FALSE, 1/0)
plot_pred &lt;- FALSE  

ecvr &lt;- cmf_krr_ecvr(
  nfolds = nfolds, 
  nreshuffles = nreshuffles, 
  act_all_fname = act_all_fname, 
  act_colnum = act_colnum, 
  sep = sep, 
  kernels_all_fname = kernels_all_fname, 
  mfields = mfields,
  ecvr_fname = ecvr_fname,
  alpha_grid_search = alpha_grid_search,
  gamma_grid_search = gamma_grid_search, 
  conic_kernel_combination = conic_kernel_combination, 
  optimize_h = optimize_h, 
  set_b_0 = set_b_0,
  seed = seed,
  print_ecvr = print_ecvr,
  plot_ecvr = plot_ecvr,
  print_ecv = print_ecv,
  plot_ecv = plot_ecv,
  print_interm_icv = print_interm_icv,
  plot_interm_icv = plot_interm_icv,
  print_final_icv = print_final_icv,
  plot_final_icv = plot_final_icv,
  print_pred = print_pred,
  plot_pred = plot_pred
)
</code></pre>
<p>in which the following parameters can be changed:</p>
<ul>
<li>nfolds – the number of folds in cross-validation (default: 5);</li>
<li>act_all_fname - the name of the text file containing the values of activity for all compounds from the training set (default: “activity-all.txt”);</li>
<li>act_colnum - activity column number in the file act_fname (default: 2);</li>
<li>sep - separator of text fields in the file act_fname containing activity values (default: “,”);</li>
<li>kernels_all_fname - the name of file with computed kernels (default: “ligands-kernels-all.RData”);</li>
<li>mfields – the list of molecular fields for which kernels should be computed (default: c(“q”,“vdw”,“logp”,“abra”,“abrb”));</li>
<li>ecvr_fname - the name of the file with the results of external cross-validation with reshuffles (default: “ligands-ecvr.RData”);</li>
<li>alpha_grid_search- whether to perform the grid search for hyper-parameter <span class="math inline">\(\alpha\)</span>f. (TRUE/FALSE) or (1/0) [This option specifies the mode of finding the optimized values of <span class="math inline">\(\alpha\)</span>f (attenuation factor for molecular fields) values. In the first mode, when alpha_grid_search=TRUE, all values of gamma taken from the grid (the fixed set of 0.01, 0.05, 0.1, 0.25, 0.5, 0.75, 1.0, 2.0, 3.0, 5.0, 10.0) are considered, the value providing the highest Q2 is chosen. In the second mode (alpha_grid_search=FALSE) <span class="math inline">\(\gamma\)</span> is included in the list of the hyper-parameters subjected to optimization using the Nelder-Mead algorithm. In this case linear interpolation of kernel values is performed.], (default: TRUE);</li>
<li>gamma_grid_search - whether to perform the grid search for hyper-parameter gamma (TRUE/FALSE) or (1/0) [This option specifies the mode of finding the optimized values of <span class="math inline">\(\gamma\)</span> (regularization parameter in KRR) values. In the first mode, when gamma_grid_search=TRUE, all values of gamma taken from the grid (the fixed set of 0.01, 0.05, 0.1, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 2.0, 2.5, 3.0, 3.5, 4.0, 5.0, 10.0, 15.0, 20.0) are considered, the value providing the highest Q2 is chosen. In the second mode (gamma_grid_search=FALSE) <span class="math inline">\(\gamma\)</span> is included in the list of the hyper-parameters subjected to optimization using the Nelder-Mead algorithm], (default: FALSE)</li>
<li>conic_kernel_combination - whether to form conic kernel combination (with positive mixing coefficients h) (TRUE/FALSE or 1/0), (default: FALSE);</li>
<li>optimize_h - whether to optimize the mixing coefficients h (TRUE/FALSE or 1/0), (default: FALSE);</li>
<li>set_b_0 - whether to set the offset b=0 (this defines the difference between KRR1 and KRR2 modifications of the KRR method) (TRUE/FALSE or 1/0), (default: FALSE);</li>
<li>seed – seed for random number generator (seed&lt;0 means that seed is not specified)</li>
<li>print_ecv - print statistical parameters of the external n-folds cross-validation procedure (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>plot_ecv - produce scatter plot for external coss-validation (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>print_interm_icv – whether to print intermediate results in the course of optimization (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>plot_interm_icv – whether to produce intermediate scatter plots in the course of optimization (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>print_final_icv – whether to print final results on internal cross-validation (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>plot_final_icv – whether to produce final scatter plot for internal cross-validation (TRUE/FALSE, 1/0), (default: TRUE);</li>
<li>print_pred – whether to print statistical parameters for prediction (TRUE/FALSE, 1/0), (default: FALSE);</li>
<li>plot_pred – whether to produce scatter plot prediction on external database (TRUE/FALSE, 1/0), (default: FALSE). Models built for each fold of the external cross-validation with reshuffles procedure and stored in the file with its results can be used for making multiple predictions for an external test set. This can be carried out using the script</li>
</ul>
<pre><code># File name for reshuffled external cross-validation
ecvr_fname &lt;- "ligands-ecvr.RData"

# Kernels for training file name
kernels_train_fname &lt;- "ligands-kernels-train.RData"

# Kernels for prediction file name
kernels_pred_fname &lt;- "ligands-kernels-pred.RData"

# Column name or activity (if specified)
act_colnum &lt;- 1

# Separator
sep &lt;- ","

# Activity for prediction set (if specified)
act_pred_fname &lt;- "activity-pred.txt"

# File with predictions
pred_fname &lt;- "ligands-ecvr-pred.RData"

# Print statistical parameters for prediction (TRUE/FALSE, 1/0)
print_pred &lt;- TRUE

# Produce scatter plot prediction on external database (TRUE/FALSE, 1/0)
plot_pred &lt;- TRUE    

ecvr_pred &lt;- cmf_krr_ecvr_pred(
  ecvr_fname = ecvr_fname, 
  kernels_train_fname = kernels_train_fname,
  kernels_pred_fname = kernels_pred_fname, 
  act_colnum = act_colnum, 
  sep = sep, 
  act_pred_fname = act_pred_fname,
  pred_fname = pred_fname,
  print_pred = print_pred,
  plot_pred = plot_pred
)
</code></pre>
<p>in which the following parameters can be changed:</p>
<ul>
<li>ecvr_fname - the name of the file with the results of external cross-validation with reshuffles (default: “ligands-ecvr.RData”);</li>
<li>kernels_train_fname - the name of file with computed kernels (default: “ligands-kernels-train.RData”);</li>
<li>kernels_pred_fname - file name of the file containing kernels that compare molecular fields of molecules belonging to the training and the test sets (default: “ligands-kernels-pred.RData”);</li>
<li>act_colnum - activity column number in the file act_pred_fname; zero value means that the activity is not specified (default: 2);</li>
<li>sep – separator of columns in file act_pred_fname (default: “,”);</li>
<li>act_pred_fname – file with activity values for the test set (if specified), (default: “activity-pred.txt”).</li>
<li>pred_fname - the name of the file containing the results of predictions (default: “ligands-ecvr-pred.mol2”);</li>
<li>print_pred – whether to print statistical parameters for prediction (TRUE/FALSE, 1/0), (default: FALSE);</li>
<li>plot_pred – whether to produce scatter plot prediction on external database (TRUE/FALSE, 1/0), (default: FALSE). Histogram of predicted values for each individual compounds can be visualized using the script</li>
</ul>
<pre><code># Visualisation of prediction histogram from multiple predictions m
# made by external cross-validation with reshuffling (ecvr)

# File with predictions
pred_fname &lt;- "ligands-ecvr-pred.RData"

# Molecule to predict
imol &lt;- 1

load(pred_fname)
hist(ecvr_pred$YPred[imol,], main="Prediction Histogram", xlab="Predicted Value", ylab="Frequency")</code></pre>
<p>in which the following parameters can be changed:</p>
<ul>
<li>pred_fname - the name of the file containing the results of predictions (default: “ligands-ecvr-pred.mol2”);</li>
<li>imol – molecule for which predictions should be done.</li>
</ul>
</div>
<div id="producing-scatter-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#producing-scatter-plots" class="anchor"></a>4.6. Producing Scatter Plots</h2>
<p>The scripts</p>
<pre><code># KRR with continuous molecular fields and optimization of  gamma and h.
# alpha is optimized by grid search
# Any combination of molecular fields is supported

# Activity file name
act_train_fname &lt;- "activity-train.txt"

# Activity column number
act_colnum &lt;- 1

# Separator
sep &lt;- ","

# Kernels file name    
kernels_train_fname &lt;- "ligands-kernels-train.RData"

# Model file name
model_fname &lt;- "ligands-model.RData"

# Types of molecular fields
mfields &lt;- c("q","vdw","logp","abra","abrb")

# Whether to perform grid search for attenuation factor alpha (TRUE/FALSE, 1/0).
alpha_grid_search &lt;- TRUE

# Whether to perform grid search for Tikhonov regularization coefficient gamma (TRUE/FALSE, 1/0).
gamma_grid_search &lt;- FALSE

# Whether to form tconic kernel combination 
conic_kernel_combination &lt;- FALSE

# Whether to optimize h (TRUE/FALSE, 1/0)
optimize_h &lt;- FALSE

# Whether to set b=0 (TRUE/FALSE, 1/0)
set_b_0 &lt;- FALSE

# Print intermediate results in the course of optimiization (TRUE/FALSE, 1/0) 
print_interm_icv &lt;- TRUE                   

# Produce intermediate scatter plots in the course of optimization  (TRUE/FALSE, 1/0)
plot_interm_icv &lt;- TRUE                   

# Print final results on interna; cross-validation (TRUE/FALSE, 1/0)
print_final_icv &lt;- TRUE

# Produce final scatter plot for internal cross-valudation (TRUE/FALSE, 1/0)                     
plot_final_icv &lt;- TRUE                       

cmf_krr_train(
  act_train_fname = act_train_fname, 
  act_colnum = act_colnum, 
  sep = sep, 
  kernels_train_fname = kernels_train_fname, 
  model_fname = model_fname, 
  mfields = mfields, 
  alpha_grid_search = alpha_grid_search,
  gamma_grid_search = gamma_grid_search, 
  conic_kernel_combination = conic_kernel_combination, 
  optimize_h = optimize_h, 
  set_b_0 = set_b_0,
  print_interm_icv = print_interm_icv,
  plot_interm_icv = plot_interm_icv,
  print_final_icv = print_final_icv,
  plot_final_icv = plot_final_icv
)
</code></pre>
<p>and</p>
<pre><code>
# Model file name
model_fname &lt;- "ligands-model.RData"

# Kernels for training file name
kernels_train_fname &lt;- "ligands-kernels-train.RData"

# Kernels for prediction file name
kernels_pred_fname &lt;- "ligands-kernels-pred.RData"

# Column name or activity (if specified)
act_colnum &lt;- 1

# Separator
sep &lt;- ","

# Activity for prediction set (if specified)
act_pred_fname &lt;- "activity-pred.txt"

# File with predictions
pred_fname &lt;- "ligands-pred.RData"

# Print statistical parameters for prediction (TRUE/FALSE, 1/0)
print_pred &lt;- TRUE

# Produce scatter plot prediction on external database (TRUE/FALSE, 1/0)
plot_pred &lt;- TRUE    

res &lt;- cmf_krr_pred(
  model_fname = model_fname, 
  kernels_train_fname = kernels_train_fname,
  kernels_pred_fname = kernels_pred_fname, 
  act_colnum = act_colnum, 
  sep = sep, 
  act_pred_fname = act_pred_fname,
  pred_fname = pred_fname,
  print_pred = print_pred,
  plot_pred = plot_pred
)
</code></pre>
<p>not only build 3D-QSAR models and use them to make predictions, but also produce the corresponding scatter plots. Meanwhile, if it is necessary to reproduce these scatter plots, two computational R scripts can be used for this purpose:</p>
<p>The below script produces the scatter plot Predicted/Expetimental for the results of internal cross-validation. The values of the following parameters may be modified in the script:</p>
<ul>
<li>fmodel - the name of the file containing model (default: “ligands-model.RData”);</li>
<li>main – the main title (default: “Scatter Plot for Cross-Validation (Internal)”);</li>
<li>xlab - text label for axis X (default: “Predicted”);</li>
<li>ylab - text label for axis Y (default: “Experimental”);</li>
<li>margin - margin for points in all directions (default: 0.5).</li>
</ul>
<pre><code># Script for drawing scatter plot for cross-validation results


# File with model
fmodel &lt;- "ligands-model.RData"

# Main title
main &lt;- "Scatter Plot for Cross-Validation (Internal)"

# Label for axis X
xlab &lt;- "Predicted"

# Label for axis Y
ylab &lt;- "Experimental"

# Margin for points in all directions
margin &lt;- 0.5

load(fmodel)

cinf_plotxy(
  model$y_pred_cv, 
  model$y_exp, 
  xlab = xlab, 
  ylab = ylab, 
  margin = margin,
  main = main
)
</code></pre>
<p>and</p>
<p>The below script produces scatter plot Predicted/Experimental for the results of predictions performed on external test set. The values of the following parameters may be modified in the script:</p>
<ul>
<li>fpred - the name of the file with predictions (default: “ligands-pred.RData”);</li>
<li>main – the main title (default: “Scatter Plot for Prediction”);</li>
<li>xlab - text label for axis X (default: “Predicted”);</li>
<li>ylab - text label for axis Y (default: “Experimental”);</li>
<li>margin - margin for points in all directions (default: 0.5)</li>
</ul>
<pre><code># Script for drawing scatter plot for predicting test set


# File with predictions
fpred &lt;- "ligands-pred.RData"

# Main title
main &lt;- "Scatter Plot for Prediction"

# Label for axis X
xlab &lt;- "Predicted"

# Label for axis Y
ylab &lt;- "Experimental"

# Margin for points in all directions
margin &lt;- 0.5

load(fpred)
cinf_plotxy(
  pred$y_pred, 
  pred$y_exp, 
  xlab=xlab, 
  ylab=ylab, 
  margin=margin, 
  main=main
)
</code></pre>
</div>
<div id="drawing-iso-surfaces-for-the-fields-of-regression-coefficients-and-their-overlap-with-molecular-fields" class="section level2">
<h2 class="hasAnchor">
<a href="#drawing-iso-surfaces-for-the-fields-of-regression-coefficients-and-their-overlap-with-molecular-fields" class="anchor"></a>4.7. Drawing Iso-surfaces for the Fields of Regression Coefficients and their Overlap with Molecular Fields</h2>
<p>The fields of regression coefficients can be visualized with the help of iso-surfaces (colored according to the sign of coefficients and the type of molecular field). The procedure for constructing such iso-surfaces includes two stages. In the first stage the values of regression coefficients are calculated on all nodes in an imaginary grid using the R computational script:</p>
<pre><code># Generation of grid for continuous molecular co-fields

# Training set file name
train_fname &lt;- "ligands-train.mol2"

# Computed kernels file name
kernels_fname &lt;- "ligands-kernels-train.RData"

# Model file name
model_fname &lt;- "ligands-model.RData"

# Grid with regression coefficients file name
grid_fname &lt;- "ligands-grid-krr.RData" 

cmf_gen_grid(
  train_fname = train_fname, 
  kernels_fname = kernels_fname, 
  model_fname = model_fname, 
  grid_fname = grid_fname
)
</code></pre>
<p>All results are written to file. The values of the following parameters may be modified in the script:</p>
<ul>
<li>train_fname - the name of the mol2 file containing the structures from the training set (default: “ligands-train.mol2”);</li>
<li>kernels_fname – file with computed kernels (default: “ligands-kernels-train.RData”);</li>
<li>model_fname - the name of the file with model (default: “ligands-model.RData”);</li>
<li>grid_fname - the name of the file containing regression coefficients computed at all grid nodes (default: “ligands-grid-krr.RData”). At the second stage, iso-surfaces for the fields of regression coefficients (co-fields) are rendered in 3D. For the sake of interpretation, a molecule from the training set is also visualized in the same picture. In order to draw it, one should launch the script:</li>
</ul>
<pre><code># View molecule with co-field


# Molecular database file name
mdb_fname &lt;- "ligands-train.mol2"

# Molecule to visualize
imol &lt;- 1

# Field type 
ft &lt;- "vdw"

# Grid with model coefficients file name
grid_fname &lt;- "ligands-grid-krr.RData" 

# Isosurface level
rlevel &lt;- 0.5

# Alpha (non-transperancy) level
alpha_g &lt;- 0.7

cmf_view_mol_field_cofield(
  mdb_fname = mdb_fname, 
  imol = imol, 
  ft = ft, 
  grid_fname = grid_fname, 
  rlevel = rlevel, 
  alpha_g = alpha_g,
  draw_field = FALSE,
  draw_cofield = TRUE
)
</code></pre>
<p>The values of the following parameters may be modified in the script:</p>
<ul>
<li>mdb_fname - the name of the mol2 file containing the structures from molecular database (default: “ligands-train.mol2”);</li>
<li>imol - a molecule to visualize (default: 1);</li>
<li>ft - the field type (q/vdw/logp/abra/abrb), (default: “logp”);</li>
<li>grid_fname - the name of the file containing model (regression) coefficients computed at all grid nodes (default: “ligands-grid-krr.RData”);</li>
<li>rlevel – isosurface level (default: 0.5);</li>
<li>alpha - alpha (non-transperancy) level for surfaces in 3D graphics (default: 0.7). One can also visualize overlapping fields of regression coefficients (i.e. co-fields) with the corresponding molecular fields. This can be done by running script:</li>
</ul>
<pre><code># View overlapping fields of regression coefficients and molecular fields

# Molecular database file name
mdb_fname &lt;- "ligands-train.mol2"

# Molecule to visualize
imol &lt;- 1

# Field type 
ft &lt;- "vdw"

# Grid with regression coefficients file name
grid_fname &lt;- "ligands-grid-krr.RData" 

# Take alpha from model? (TRUE/FALSE)
alpha_from_model &lt;- TRUE

# Model file name
model_fname &lt;- "ligands-model.RData"

# Alpha value (if not taken from model)
alpha &lt;- 1.0

# Isosurface level
rlevel &lt;- 0.5

# Alpha (non-transperancy) level
alpha_g &lt;- 0.5

# Whether to draw overlap between field and co-field
draw_overlap &lt;- TRUE

cmf_view_mol_field_cofield(
  mdb_fname = mdb_fname, 
  imol = imol, 
  ft = ft, 
  grid_fname = grid_fname, 
  alpha_from_model = alpha_from_model, 
  model_fname = model_fname, 
  alpha = alpha, 
  rlevel = rlevel, 
  alpha_g = alpha_g,
  draw_field = TRUE,
  draw_cofield = TRUE,
  draw_overlap = draw_overlap
)

</code></pre>
<p>One can change the default values of the following parameters in this script:</p>
<ul>
<li>mdb_fname - the name of the mol2 file containing the structures from molecular database (default: “ligands-train.mol2”);</li>
<li>imol - a molecule to visualize (default: 1);</li>
<li>ft - the field type (q/vdw/logp/abra/abrb), (default: “vdw”);</li>
<li>grid_fname - the name of the file containing model (regression) coefficients computed at all - - grid nodes (default: “ligands-grid-krr.RData”);</li>
<li>alpha_from_model – whether to take the attenuation parameter <span class="math inline">\(\alpha\)</span>f from the stored model (TRUE/FALSE or 1/0), (default: TRUE);</li>
<li>model_fname – model file name (from which the values of the attenuation parameter <span class="math inline">\(\alpha\)</span>f should be taken whenever alpha_from_model=TRUE), (default: “ligands-model.RData”);</li>
<li>alpha – the value of the attenuation parameter <span class="math inline">\(\alpha\)</span>f (default: 1.0);</li>
<li>rlevel – isosurface level (for both the fields of regression coefficients and molecular fields), (default: 0.5);</li>
<li>alpha_g – non-transperancy level for surfaces (default: 0.5);</li>
<li>draw_overlap – whether to visualize the overlap separately with additional iso-surfaces (TRUE/FALSE or 1/0) (default: FALSE).</li>
</ul>
<p>Molecular fields without fields of regression coefficients can be visualized using the below computational R script:</p>
<pre><code>
# View overlapping fields of regression coefficients and molecular fields

# Molecular database file name
mdb_fname &lt;- "ligands-train.mol2"

# Molecule to visualize
imol &lt;- 1

# Field type 
ft &lt;- "vdw"

# Take alpha from model? (TRUE/FALSE)
alpha_from_model &lt;- TRUE

# Model file name
model_fname &lt;- "ligands-model.RData"

# Alpha value (if not taken from model)
alpha &lt;- 1.0

# Isosurface level
rlevel &lt;- 0.5

# Alpha (non-transperancy) level
alpha_g &lt;- 0.5

cmf_view_mol_field_cofield(
  mdb_fname = mdb_fname, 
  imol = imol, 
  ft = ft, 
  grid_fname = grid_fname, 
  alpha_from_model = alpha_from_model, 
  model_fname = model_fname, 
  alpha = alpha, 
  rlevel = rlevel, 
  alpha_g = alpha_g,
  draw_field = TRUE,
  draw_cofield = FALSE
)

</code></pre>
<p>Default values of the following parameters can be changed in it:</p>
<ul>
<li>mdb_fname - the name of the mol2 file containing the structures from molecular database (default: “ligands-train.mol2”);</li>
<li>imol - a molecule to visualize (default: 1);</li>
<li>ft - the field type (q/vdw/logp/abra/abrb), (default: “vdw”);</li>
<li>alpha_from_model – whether to take the attenuation parameter <span class="math inline">\(\alpha\)</span>f from the stored model (TRUE/FALSE or 1/0), (default: TRUE);</li>
<li>model_fname – model file name (from which the values of the attenuation parameter <span class="math inline">\(\alpha\)</span>f should be taken whenever alpha_from_model=TRUE), (default: “ligands-model.RData”);</li>
<li>alpha – the value of the attenuation parameter <span class="math inline">\(\alpha\)</span>f (default: 1.0);</li>
<li>rlevel – isosurface level (for both the fields of regression coefficients and molecular fields), (default: 0.5);</li>
<li>alpha_g – non-transperancy level for surfaces (default: 0.5.</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#inrtoduction">1. Inrtoduction</a></li>
      <li><a href="#installation-and-setup-of-the-required-software">2. Installation and Setup of the Required Software</a></li>
      <li><a href="#the-basic-workflow-for-building-3d-qsar-models-using-the-cmf-approach">4. The Basic Workflow for Building 3D-QSAR Models Using the CMF Approach</a></li>
      <li><a href="#aligning-molecules">4.1. Aligning molecules</a></li>
      <li><a href="#computing-kernels-for-the-training-set">4.2. Computing kernels for the training set</a></li>
      <li><a href="#building-3d-qsar-regression-model-using-the-training-set">4.3. Building 3D-QSAR regression model using the training set</a></li>
      <li><a href="#the-use-of-3d-qsar-model-for-predicting-activities-of-test-set-compounds">4.4. The Use of 3D-QSAR Model for Predicting Activities of Test Set Compounds</a></li>
      <li><a href="#building-3d-qsar-models-using-external-n-fold-cross-validation">4.5. Building 3D-QSAR models using external n-fold cross-validation</a></li>
      <li><a href="#producing-scatter-plots">4.6. Producing Scatter Plots</a></li>
      <li><a href="#drawing-iso-surfaces-for-the-fields-of-regression-coefficients-and-their-overlap-with-molecular-fields">4.7. Drawing Iso-surfaces for the Fields of Regression Coefficients and their Overlap with Molecular Fields</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Igor Baskin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
